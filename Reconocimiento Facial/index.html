<!DOCTYPE html>
<!--
    SISTEMA DE LOGIN CON RECONOCIMIENTO FACIAL - HTML DOCUMENTADO
    ===============================================================
    
    Este archivo HTML contiene la estructura completa del sistema de autenticaci√≥n
    facial, incluyendo elementos de interfaz, scripts de carga y optimizaciones.
    
    CARACTER√çSTICAS PRINCIPALES:
    - Interfaz responsive y accesible
    - Carga inteligente de bibliotecas con fallbacks
    - Sistema de diagn√≥stico y monitoreo
    - Optimizaciones de rendimiento (preconnect, defer)
    - Progressive Web App (PWA) ready
    - Soporte para m√∫ltiples dispositivos y navegadores
    
    ARQUITECTURA DE LA P√ÅGINA:
    1. Head: Metadatos, scripts de diagn√≥stico y carga de bibliotecas
    2. Styles: CSS cr√≠tico inline para renderizado inmediato
    3. Body: Estructura principal de la interfaz
    4. Scripts: Funcionalidades adicionales y mejoras de UX
    
    TECNOLOG√çAS INTEGRADAS:
    - Face-API.js: Reconocimiento facial con TensorFlow.js
    - CSS Grid/Flexbox: Layout responsivo moderno
    - Service Workers: Capacidades offline (opcional)
    - Web Components: Componentes reutilizables
    - Progressive Enhancement: Funcionalidad por capas
    
    COMPATIBILIDAD:
    - Chrome 60+ (recomendado)
    - Firefox 55+
    - Safari 12+
    - Edge 79+
    - Dispositivos m√≥viles con iOS 12+ y Android 8+
    
    AUTOR: Hector Arciniega
    VERSI√ìN: 2.0
    FECHA: 2025
-->
<html lang="es">
<head>
    <!-- =================================================================
         METADATOS B√ÅSICOS Y CONFIGURACI√ìN
         ================================================================= -->
    
    <!--
        CODIFICACI√ìN DE CARACTERES
        UTF-8 asegura soporte completo para caracteres especiales,
        emojis y texto en m√∫ltiples idiomas
    -->
    <meta charset="UTF-8">
    
    <!--
        CONFIGURACI√ìN DE VIEWPORT RESPONSIVE
        - width=device-width: Ancho igual al del dispositivo
        - initial-scale=1.0: Sin zoom inicial
        - Esencial para dise√±o responsive en m√≥viles
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!--
        SEO Y METADATOS DESCRIPTIVOS
        Informaci√≥n para motores de b√∫squeda y redes sociales
    -->
    <meta name="description" content="Sistema de autenticaci√≥n mediante reconocimiento facial con IA">
    <meta name="keywords" content="login facial, reconocimiento facial, autenticaci√≥n, IA, seguridad">
    <meta name="author" content="Hector Arciniega">
    
    <!--
        T√çTULO DE LA P√ÅGINA
        Aparece en la pesta√±a del navegador y en resultados de b√∫squeda
    -->
    <title>Login con Reconocimiento Facial - Intranet Corporativa</title>
    
    <!-- =================================================================
         OPTIMIZACIONES DE RENDIMIENTO
         ================================================================= -->
    
    <!--
        PRECONNECT PARA CDNs
        Establece conexiones tempranas a dominios externos cr√≠ticos
        Mejora significativamente los tiempos de carga
    -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- =================================================================
         SCRIPTS DE DIAGN√ìSTICO Y MONITOREO
         ================================================================= -->
    
    <!--
        SISTEMA DE DIAGN√ìSTICO INICIAL
        Ejecuta verificaciones de conectividad y compatibilidad
        antes de cargar el sistema principal
    -->
    <script>
        // Banner de inicio del sistema con informaci√≥n t√©cnica
        console.log('üîç Iniciando diagn√≥stico del sistema...');
        console.log('üåê Navegador:', navigator.userAgent);
        console.log('üîí Protocolo:', window.location.protocol);
        console.log('üì° Conexi√≥n:', navigator.onLine ? 'Activa' : 'Inactiva');
        
        /**
         * TEST DE CONECTIVIDAD B√ÅSICA
         * Verifica que el dispositivo puede realizar requests HTTP
         * Usa httpbin.org como servicio confiable de testing
         */
        fetch('https://httpbin.org/get')
            .then(() => console.log('‚úÖ Conectividad b√°sica: OK'))
            .catch(() => console.log('‚ùå Conectividad b√°sica: FALLO'));
        
        /**
         * TEST ESPEC√çFICO DE CDNs
         * Verifica accesibilidad a los CDNs principales para Face-API.js
         * Permite identificar bloqueos de firewall o problemas de red
         */
        const testCDNs = [
            'https://cdn.jsdelivr.net',      // CDN principal (JSDelivr)
            'https://unpkg.com',             // CDN alternativo (NPM)
            'https://cdnjs.cloudflare.com'   // CDN respaldo (Cloudflare)
        ];
        
        testCDNs.forEach(cdn => {
            fetch(cdn)
                .then(() => console.log(`‚úÖ CDN ${cdn}: Accesible`))
                .catch(() => console.log(`‚ùå CDN ${cdn}: Bloqueado`));
        });
    </script>
    
    <!-- =================================================================
         CARGA INTELIGENTE DE FACE-API.JS
         ================================================================= -->
    
    <!--
        SISTEMA DE CARGA CON FALLBACKS M√öLTIPLES
        Intenta cargar Face-API.js desde m√∫ltiples CDNs con timeout
        y manejo de errores robusto
    -->
    <script>
        /**
         * CONFIGURACI√ìN DE CDNs CON PRIORIDAD
         * Array ordenado por confiabilidad y velocidad
         */
        const cdnSources = [
            'https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js',
            'https://unpkg.com/face-api.js@0.22.2/dist/face-api.min.js',
            'https://cdnjs.cloudflare.com/ajax/libs/face-api.js/0.22.2/face-api.min.js'
        ];
        
        // Variables de control de carga
        let currentCDN = 0;           // √çndice del CDN actual
        let faceApiLoaded = false;    // Flag de carga exitosa
        
        /**
         * FUNCI√ìN DE CARGA RECURSIVA CON FALLBACK
         * Intenta cargar desde cada CDN secuencialmente hasta encontrar uno funcional
         * 
         * @returns {Promise} Promesa que se resuelve cuando la carga es exitosa
         */
        function loadFaceAPI() {
            return new Promise((resolve, reject) => {
                // Verificar si ya se agotaron todos los CDNs
                if (currentCDN >= cdnSources.length) {
                    reject(new Error('Todos los CDNs fallaron'));
                    return;
                }
                
                console.log(`üîÑ Intentando cargar face-api.js desde: ${cdnSources[currentCDN]}`);
                
                /**
                 * CREACI√ìN DIN√ÅMICA DE SCRIPT TAG
                 * Permite control total sobre la carga y manejo de errores
                 */
                const script = document.createElement('script');
                script.src = cdnSources[currentCDN];
                script.defer = true;  // Carga diferida para no bloquear el parsing
                
                /**
                 * TIMEOUT DE SEGURIDAD
                 * 10 segundos m√°ximo por CDN para evitar bloqueos indefinidos
                 */
                const timeout = setTimeout(() => {
                    console.warn(`‚è∞ Timeout para CDN: ${cdnSources[currentCDN]}`);
                    script.onerror(); // Disparar manejo de error
                }, 10000);
                
                /**
                 * MANEJO DE CARGA EXITOSA
                 * Se ejecuta cuando el script se carga completamente
                 */
                script.onload = () => {
                    clearTimeout(timeout);
                    console.log(`‚úÖ Face-api.js cargado desde: ${cdnSources[currentCDN]}`);
                    faceApiLoaded = true;
                    resolve();
                };
                
                /**
                 * MANEJO DE ERRORES DE CARGA
                 * Se ejecuta si el CDN falla o el timeout se cumple
                 */
                script.onerror = () => {
                    clearTimeout(timeout);
                    console.warn(`‚ùå Fall√≥ CDN: ${cdnSources[currentCDN]}`);
                    currentCDN++;
                    
                    // Limpiar script fallido del DOM
                    if (document.head.contains(script)) {
                        document.head.removeChild(script);
                    }
                    
                    // Intentar siguiente CDN o fallar definitivamente
                    if (currentCDN < cdnSources.length) {
                        loadFaceAPI().then(resolve).catch(reject);
                    } else {
                        reject(new Error('Todos los CDNs fallaron'));
                    }
                };
                
                // Agregar script al DOM para iniciar la carga
                document.head.appendChild(script);
            });
        }
        
        /**
         * INICIAR PROCESO DE CARGA CON MANEJO DE ERRORES
         * Maneja tanto √©xito como fallo de la carga de bibliotecas
         */
        loadFaceAPI()
            .then(() => {
                console.log('üéâ Face-api.js cargado exitosamente');
            })
            .catch((error) => {
                console.error('‚ùå Error cr√≠tico:', error.message);
                
                /**
                 * MODO DEGRADADO CON NOTIFICACI√ìN AL USUARIO
                 * Si falla la carga de IA, proporcionar funcionalidad b√°sica
                 */
                setTimeout(() => {
                    const status = document.getElementById('status');
                    if (status) {
                        status.className = 'status error';
                        status.innerHTML = '‚ùå Error: No se pueden cargar las bibliotecas de IA.<br><small>Verifica tu conexi√≥n o firewall</small>';
                        
                        /**
                         * ACTIVACI√ìN DE MODO B√ÅSICO
                         * Habilitar funciones que no requieren IA despu√©s de delay
                         */
                        setTimeout(() => {
                            status.className = 'status info';
                            status.innerHTML = 'üì± Modo b√°sico disponible. Algunas funciones limitadas.';
                            
                            // Habilitar botones que funcionan sin IA
                            const startBtn = document.getElementById('startCamera');
                            const clearBtn = document.getElementById('clearData');
                            if (startBtn) startBtn.disabled = false;
                            if (clearBtn) clearBtn.disabled = false;
                        }, 3000);
                    }
                }, 2000);
            });
        
        /**
         * VERIFICACI√ìN DE TIMEOUT GLOBAL
         * Alerta si la carga toma m√°s de 15 segundos
         */
        setTimeout(() => {
            if (!faceApiLoaded) {
                console.error('‚ö†Ô∏è Face-api.js no se carg√≥ en 15 segundos');
            }
        }, 15000);
    </script>
    
    <!-- =================================================================
         ENLACE A HOJA DE ESTILOS EXTERNA
         ================================================================= -->
    
    <!--
        HOJA DE ESTILOS PRINCIPAL
        Carga los estilos completos desde archivo externo
        para mejor organizaci√≥n y caching
    -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- =================================================================
         CSS CR√çTICO INLINE
         ================================================================= -->
    
    <!--
        ESTILOS CR√çTICOS PARA RENDERIZADO INMEDIATO
        CSS inline que asegura el correcto renderizado inicial
        antes de que se cargue la hoja de estilos externa
    -->
    <style>
        /**
         * RESET UNIVERSAL CR√çTICO
         * Elimina inconsistencias entre navegadores
         */
        *, *::before, *::after {
            margin: 0 !important;
            padding: 0 !important;
            box-sizing: border-box !important;
        }
        
        /**
         * CONFIGURACI√ìN BASE DEL HTML Y BODY
         * Establece la base para el layout de p√°gina completa
         */
        html {
            height: 100% !important;        /* Altura completa del viewport */
            width: 100% !important;         /* Ancho completo del viewport */
        }
        
        body {
            height: 100vh !important;       /* Altura del viewport (incluye barras) */
            width: 100vw !important;        /* Ancho del viewport */
            margin: 0 !important;           /* Sin m√°rgenes */
            padding: 20px !important;       /* Padding para espaciado interno */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            background-attachment: fixed !important;  /* Fondo fijo durante scroll */
            display: flex !important;       /* Flexbox para centrado */
            flex-direction: column !important;
            justify-content: center !important;  /* Centrado vertical */
            align-items: center !important;      /* Centrado horizontal */
            box-sizing: border-box !important;
            overflow-x: hidden !important;  /* Sin scroll horizontal */
            overflow-y: auto !important;    /* Scroll vertical si es necesario */
        }
        
        /**
         * CONTENEDOR PRINCIPAL CON GLASSMORPHISM
         * Dise√±o moderno con efecto de vidrio esmerilado
         */
        .login-container {
            background: rgba(255, 255, 255, 0.95) !important;  /* Fondo semi-transparente */
            backdrop-filter: blur(10px) !important;             /* Efecto de desenfoque */
            -webkit-backdrop-filter: blur(10px) !important;     /* Soporte Safari */
            border-radius: 20px !important;                     /* Bordes redondeados */
            padding: 40px !important;                           /* Espaciado interno */
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1) !important;  /* Sombra suave */
            max-width: 500px !important;                        /* Ancho m√°ximo */
            width: 100% !important;                             /* Ancho responsive */
            text-align: center !important;                      /* Texto centrado */
            position: relative !important;                      /* Para posicionamiento de hijos */
            margin: auto !important;                            /* Centrado autom√°tico */
            box-sizing: border-box !important;                  /* Include padding en width */
            flex-shrink: 0 !important;                          /* No encogerse en flexbox */
        }
        
        /**
         * PANEL DE INSTRUCCIONES
         * √Årea informativa con estilo distintivo
         */
        .instructions {
            background: linear-gradient(135deg, #e3f2fd, #f0f9ff) !important;  /* Gradiente azul */
            border: 1px solid #2196F3 !important;               /* Borde azul */
            border-radius: 15px !important;                     /* Bordes redondeados */
            padding: 20px !important;                           /* Espaciado interno */
            margin: 20px 0 !important;                          /* M√°rgenes verticales */
            text-align: left !important;                        /* Texto alineado izquierda */
            box-sizing: border-box !important;                  /* Box-sizing consistente */
        }
        
        /**
         * T√çTULOS DE INSTRUCCIONES
         * Estilo para encabezados de secciones informativas
         */
        .instructions h3 {
            color: #1565C0 !important;                          /* Azul oscuro */
            margin: 0 0 15px 0 !important;                      /* Margen solo inferior */
            display: flex !important;                           /* Flexbox para alineaci√≥n */
            align-items: center !important;                     /* Centrado vertical */
            gap: 10px !important;                               /* Espacio entre elementos */
            font-size: 1.1rem !important;                       /* Tama√±o de fuente */
        }
        
        /**
         * LISTAS EN INSTRUCCIONES
         * Estilo personalizado para listas sin marcadores
         */
        .instructions ul {
            color: #1565C0 !important;                          /* Color azul */
            padding: 0 !important;                              /* Sin padding */
            margin: 0 !important;                               /* Sin margen */
            list-style: none !important;                        /* Sin marcadores de lista */
        }
        
        /**
         * ITEMS DE LISTA CON INDICADORES PERSONALIZADOS
         * Cada item tiene un indicador visual personalizado
         */
        .instructions li {
            margin: 10px 0 !important;                          /* M√°rgenes verticales */
            padding: 0 0 0 30px !important;                     /* Padding izquierdo para indicador */
            position: relative !important;                      /* Para posicionar el indicador */
            line-height: 1.5 !important;                        /* Altura de l√≠nea c√≥moda */
            color: #1565C0 !important;                          /* Color del texto */
        }
        
        /**
         * INDICADOR VISUAL DE LISTA
         * Flecha personalizada como marcador de lista
         */
        .instructions li::before {
            content: '‚ñ∂' !important;                            /* Car√°cter de flecha */
            position: absolute !important;                      /* Posicionamiento absoluto */
            left: 10px !important;                              /* Posici√≥n desde la izquierda */
            top: 0 !important;                                  /* Alineado al tope */
            color: #2196F3 !important;                          /* Color azul m√°s claro */
            font-size: 0.8rem !important;                       /* Tama√±o m√°s peque√±o */
        }
        
        /**
         * INDICADOR DE CONEXI√ìN FLOTANTE
         * Componente fijo que muestra el estado de conexi√≥n
         */
        .connection-status {
            position: fixed !important;                         /* Posici√≥n fija al viewport */
            bottom: 20px !important;                            /* 20px desde el fondo */
            left: 20px !important;                              /* 20px desde la izquierda */
            background: rgba(0, 0, 0, 0.8) !important;          /* Fondo negro transparente */
            color: white !important;                            /* Texto blanco */
            padding: 10px 15px !important;                      /* Espaciado interno */
            border-radius: 20px !important;                     /* Bordes muy redondeados */
            font-size: 0.8rem !important;                       /* Texto peque√±o */
            display: flex !important;                           /* Flexbox para alineaci√≥n */
            align-items: center !important;                     /* Centrado vertical */
            gap: 8px !important;                                /* Espacio entre elementos */
            z-index: 1000 !important;                           /* Z-index alto para estar encima */
            box-sizing: border-box !important;                  /* Box-sizing consistente */
        }
        
        /**
         * INDICADOR VISUAL DE CONEXI√ìN
         * Punto circular que cambia color seg√∫n la conexi√≥n
         */
        .connection-indicator {
            width: 8px !important;                              /* Ancho del c√≠rculo */
            height: 8px !important;                             /* Alto del c√≠rculo */
            border-radius: 50% !important;                      /* C√≠rculo perfecto */
            background: #28a745 !important;                     /* Verde por defecto (conectado) */
            flex-shrink: 0 !important;                          /* No encogerse */
        }
        
        /**
         * CONTENEDOR DE CONTROLES
         * √Årea que contiene los botones principales
         */
        .controls {
            margin: 30px 0 !important;                          /* M√°rgenes verticales */
            padding: 0 !important;                              /* Sin padding */
            display: flex !important;                           /* Flexbox para distribuci√≥n */
            gap: 15px !important;                               /* Espacio entre botones */
            justify-content: center !important;                 /* Centrado horizontal */
            flex-wrap: wrap !important;                         /* Permite envolver botones */
        }
        
        /**
         * ESTILO BASE DE BOTONES
         * Dise√±o moderno con gradientes y efectos
         */
        .btn {
            margin: 5px !important;                             /* M√°rgenes peque√±os */
            padding: 12px 25px !important;                      /* Espaciado interno */
            border: none !important;                            /* Sin borde */
            border-radius: 25px !important;                     /* Bordes muy redondeados */
            background: linear-gradient(45deg, #667eea, #764ba2) !important;  /* Gradiente */
            color: white !important;                            /* Texto blanco */
            font-weight: 600 !important;                        /* Peso semi-bold */
            cursor: pointer !important;                         /* Cursor de puntero */
            min-width: 120px !important;                        /* Ancho m√≠nimo */
        }
        
        /**
         * DISE√ëO RESPONSIVE PARA M√ìVILES
         * Adaptaciones para pantallas peque√±as (< 600px)
         */
        @media (max-width: 600px) {
            body {
                padding: 10px !important;                       /* Padding reducido */
            }
            
            .login-container {
                padding: 25px !important;                       /* Padding reducido */
                margin: 5px !important;                         /* M√°rgenes m√≠nimos */
                border-radius: 15px !important;                 /* Bordes menos redondeados */
            }
            
            .controls {
                flex-direction: column !important;              /* Layout vertical */
                align-items: center !important;                 /* Centrado horizontal */
                gap: 10px !important;                           /* Espacio reducido */
            }
            
            .btn {
                width: 100% !important;                         /* Ancho completo */
                max-width: 250px !important;                    /* Ancho m√°ximo */
                margin: 2px 0 !important;                       /* M√°rgenes verticales */
            }
            
            .instructions {
                padding: 15px !important;                       /* Padding reducido */
            }
        }
    </style>
    
    <!-- =================================================================
         PWA Y METADATOS ADICIONALES
         ================================================================= -->
    
    <!--
        FAVICON DIN√ÅMICO CON SVG
        √çcono de la pesta√±a usando emoji de candado
    -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'><text y='32' font-size='32'>üîê</text></svg>">
    
    <!--
        COLOR DE TEMA PARA M√ìVILES
        Define el color de la barra de estado en dispositivos m√≥viles
    -->
    <meta name="theme-color" content="#667eea">
    
    <!--
        METADATOS PWA (PROGRESSIVE WEB APP)
        Configuraci√≥n para comportamiento de aplicaci√≥n nativa
    -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Login Facial">
</head>

<!-- =================================================================
     CUERPO PRINCIPAL DE LA P√ÅGINA
     ================================================================= -->
<body>
    <!-- =================================================================
         COMPONENTES DE INTERFAZ FLOTANTES
         ================================================================= -->
    
    <!--
        INDICADOR DE CONEXI√ìN FLOTANTE
        Componente que muestra el estado de conectividad en tiempo real
        Posicionado de forma fija en la esquina inferior izquierda
    -->
    <div class="connection-status" id="connectionStatus">
        <!-- Indicador visual circular que cambia color -->
        <div class="connection-indicator" id="connectionIndicator"></div>
        <!-- Texto descriptivo del estado -->
        <span id="connectionText">Conectado</span>
    </div>

    <!-- =================================================================
         CONTENEDOR PRINCIPAL DE LA APLICACI√ìN
         ================================================================= -->
    
    <!--
        CONTENEDOR PRINCIPAL CON GLASSMORPHISM
        Envuelve toda la interfaz principal del sistema de login
    -->
    <div class="login-container">
        
        <!-- =============================================================
             HEADER MODERNO CON DISE√ëO AVANZADO
             ============================================================= -->
        
        <!--
            HEADER CON EFECTOS VISUALES
            Secci√≥n superior con gradientes, animaciones y branding
        -->
        <div class="login-header">
            <!-- Fondo animado con efectos de luz -->
            <div class="header-background"></div>
            
            <!-- Contenido principal del header -->
            <div class="header-content">
                <!-- Contenedor del √≠cono principal con efectos -->
                <div class="face-icon-container">
                    <!-- √çcono principal (emoji de candado) -->
                    <span class="face-icon">üîê</span>
                    <!-- Efecto de resplandor detr√°s del √≠cono -->
                    <div class="icon-glow"></div>
                </div>
                
                <!-- T√≠tulo principal de la aplicaci√≥n -->
                <h1>Login Facial</h1>
                
                <!-- Subt√≠tulo descriptivo -->
                <p class="header-subtitle">Sistema de Autenticaci√≥n Inteligente</p>
                
                <!-- Divisor decorativo -->
                <div class="header-divider"></div>
            </div>
        </div>
        
        <!-- =============================================================
             ALERTAS Y NOTIFICACIONES DE SEGURIDAD
             ============================================================= -->
        
        <!--
            ALERTA DE SEGURIDAD DIN√ÅMICA
            Se muestra cuando hay intentos fallidos de autenticaci√≥n
            Inicialmente oculta, se activa via JavaScript
        -->
        <div id="securityWarning" class="security-warning hidden">
            <!-- √çcono de advertencia -->
            <span>‚ö†Ô∏è</span>
            <!-- Contenido del mensaje de seguridad -->
            <div>
                <strong>Advertencia de Seguridad:</strong>
                <span id="securityMessage">M√∫ltiples intentos de acceso detectados.</span>
            </div>
        </div>
        
        <!-- =============================================================
             PANEL DE INSTRUCCIONES DE USO
             ============================================================= -->
        
        <!--
            INSTRUCCIONES PASO A PASO
            Gu√≠a visual para el usuario sobre c√≥mo usar el sistema
        -->
        <div class="instructions">
            <!-- T√≠tulo del panel de instrucciones -->
            <h3>üìã Instrucciones de Uso:</h3>
            
            <!-- Lista de pasos con indicadores visuales personalizados -->
            <ul>
                <li>Permite el acceso a la c√°mara cuando se solicite</li>
                <li>Haz clic en "Iniciar C√°mara" para activar el sistema</li>
                <li>Si eres nuevo, usa "Registrar Cara" para guardar tu perfil facial</li>
                <li>Luego usa "Iniciar Reconocimiento" para hacer login autom√°tico</li>
                <li>Mant√©n tu cara centrada y bien iluminada para mejores resultados</li>
                <li>El sistema te redirigir√° autom√°ticamente al escritorio tras el login</li>
            </ul>
        </div>

        <!-- =============================================================
             √ÅREA DE VIDEO Y PROCESAMIENTO VISUAL
             ============================================================= -->
        
        <!--
            CONTENEDOR DE C√ÅMARA Y CANVAS
            √Årea donde se muestra el video de la c√°mara y los overlays de detecci√≥n
        -->
        <div class="camera-container" id="cameraContainer">
            <!--
                ELEMENTO VIDEO
                Stream en vivo de la c√°mara web del usuario
                - autoplay: Inicia autom√°ticamente cuando se asigna el stream
                - muted: Sin audio para evitar feedback
                - playsinline: Reproducci√≥n inline en dispositivos m√≥viles
            -->
            <video id="video" autoplay muted playsinline></video>
            
            <!--
                ELEMENTO CANVAS
                Capa de overlay para dibujar detecciones faciales
                Permite visualizar bounding boxes, landmarks y informaci√≥n
            -->
            <canvas id="canvas"></canvas>
        </div>

        <!-- =============================================================
             INDICADORES DE PROGRESO Y CARGA
             ============================================================= -->
        
        <!--
            CONTENEDOR DE PROGRESO PARA CARGA DE MODELOS
            Se muestra durante la carga de modelos de IA
            Inicialmente oculto, se activa via JavaScript
        -->
        <div id="progressContainer" class="hidden">
            <!-- Barra de progreso visual -->
            <div class="progress-bar">
                <!-- Relleno animado que indica el progreso -->
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            
            <!-- Texto descriptivo del progreso -->
            <p style="text-align: center; font-size: 0.9rem; color: #666; margin: 5px 0;">
                Cargando modelos de IA: <span id="progressText">0%</span>
            </p>
        </div>

        <!-- =============================================================
             INDICADOR DE ESTADO DEL SISTEMA
             ============================================================= -->
        
        <!--
            √ÅREA DE MENSAJES DE ESTADO
            Muestra el estado actual del sistema con spinner opcional
            Se actualiza din√°micamente via JavaScript
        -->
        <div class="status loading" id="status">
            <!-- Spinner animado para estados de carga -->
            <div class="spinner"></div>
            Conectando al sistema...
        </div>

        <!-- =============================================================
             CONTROLES PRINCIPALES DE LA APLICACI√ìN
             ============================================================= -->
        
        <!--
            PANEL DE BOTONES PRINCIPALES
            Contiene todas las acciones principales del usuario
        -->
        <div class="controls">
            <!--
                BOT√ìN INICIAR C√ÅMARA
                Activa la c√°mara web para captura de video
                data-tooltip: Informaci√≥n de ayuda para el usuario
            -->
            <button class="btn" id="startCamera" 
                    data-tooltip="Activar c√°mara para capturar video">
                üìπ Iniciar C√°mara
            </button>
            
            <!--
                BOT√ìN REGISTRAR CARA
                Permite registrar un nuevo usuario en el sistema
                Inicialmente deshabilitado hasta que la c√°mara est√© activa
            -->
            <button class="btn" id="registerFace" disabled 
                    data-tooltip="Registrar tu rostro en el sistema">
                üë§ Registrar Cara
            </button>
            
            <!--
                BOT√ìN INICIAR RECONOCIMIENTO
                Activa el proceso de reconocimiento facial autom√°tico
                Clase 'success' para indicar acci√≥n principal positiva
            -->
            <button class="btn success" id="recognizeFace" disabled 
                    data-tooltip="Iniciar reconocimiento autom√°tico">
                üîç Iniciar Reconocimiento
            </button>
            
            <!--
                BOT√ìN LIMPIAR DATOS
                Elimina todos los usuarios registrados del sistema
                Clase 'danger' para indicar acci√≥n destructiva
            -->
            <button class="btn danger" id="clearData" 
                    data-tooltip="Eliminar todos los usuarios registrados">
                üóëÔ∏è Limpiar Datos
            </button>
        </div>

        <!-- =============================================================
             SECCI√ìN DE USUARIOS REGISTRADOS
             ============================================================= -->
        
        <!--
            PANEL DE USUARIOS REGISTRADOS
            Muestra tarjetas visuales de todos los usuarios en el sistema
        -->
        <div class="user-profiles" id="userProfiles">
            <!-- T√≠tulo de la secci√≥n -->
            <h3>üë• Usuarios Registrados:</h3>
            
            <!--
                CONTENEDOR DE LISTA DE PERFILES
                Se puebla din√°micamente via JavaScript con tarjetas de usuario
            -->
            <div id="profilesList">
                <!--
                    MENSAJE INICIAL CUANDO NO HAY USUARIOS
                    Se reemplaza cuando se registran usuarios
                -->
                <p style="color: #666; font-style: italic; text-align: center;">
                    No hay usuarios registrados a√∫n
                </p>
            </div>
        </div>

        <!-- =============================================================
             PANEL DE AYUDA Y ATAJOS DE TECLADO
             ============================================================= -->
        
        <!--
            INFORMACI√ìN DE ATAJOS DE TECLADO
            Panel informativo sobre los shortcuts disponibles
        -->
        <div class="instructions" style="margin-top: 20px;">
            <!-- T√≠tulo del panel de atajos -->
            <h3>‚å®Ô∏è Atajos de Teclado:</h3>
            
            <!-- Lista de atajos con sus funciones -->
            <ul>
                <li><strong>C</strong> - Iniciar c√°mara</li>
                <li><strong>R</strong> - Registrar cara</li>
                <li><strong>S</strong> - Iniciar/detener reconocimiento</li>
                <li><strong>ESC</strong> - Detener reconocimiento</li>
                <li><strong>?</strong> - Mostrar/ocultar ayuda</li>
            </ul>
        </div>
    </div>

    <!-- =================================================================
         OVERLAYS Y COMPONENTES MODALES
         ================================================================= -->
    
    <!--
        OVERLAY DE CARGA DE PANTALLA COMPLETA
        Se muestra durante procesos importantes que requieren espera
        Bloquea la interacci√≥n hasta completarse
    -->
    <div class="loading-overlay" id="loadingOverlay">
        <!-- Contenido central del overlay -->
        <div class="loading-content">
            <!-- Spinner grande para procesos importantes -->
            <div class="loading-spinner-large"></div>
            
            <!-- T√≠tulo del proceso de carga -->
            <h3 style="margin: 0; color: #333;">Cargando...</h3>
            
            <!-- Mensaje descriptivo del proceso actual -->
            <p style="margin: 10px 0 0 0; color: #666;" id="loadingMessage">
                Inicializando sistema
            </p>
        </div>
    </div>

    <!--
        PANEL FLOTANTE DE AYUDA DE ATAJOS
        Informaci√≥n contextual sobre shortcuts de teclado
        Se muestra/oculta con la tecla '?' o 'H'
    -->
    <div class="shortcuts-help" id="shortcutsHelp">
        <!-- T√≠tulo del panel de ayuda -->
        <h4 style="margin: 0 0 10px 0; color: #fff;">Atajos de Teclado</h4>
        
        <!-- Lista de atajos con formato de tabla -->
        <div class="shortcut-item">
            <span>Iniciar c√°mara</span>
            <span class="shortcut-key">C</span>
        </div>
        <div class="shortcut-item">
            <span>Registrar cara</span>
            <span class="shortcut-key">R</span>
        </div>
        <div class="shortcut-item">
            <span>Reconocimiento</span>
            <span class="shortcut-key">S</span>
        </div>
        <div class="shortcut-item">
            <span>Detener</span>
            <span class="shortcut-key">ESC</span>
        </div>
        <div class="shortcut-item">
            <span>Ayuda</span>
            <span class="shortcut-key">?</span>
        </div>
    </div>

    <!-- =================================================================
         SCRIPTS ADICIONALES Y MEJORAS DE UX
         ================================================================= -->
    
    <!--
        SCRIPT DE MEJORAS DE EXPERIENCIA DE USUARIO
        Funcionalidades adicionales que mejoran la interacci√≥n
    -->
    <script>
        // =============================================================
        // VARIABLES GLOBALES PARA MEJORAS UX
        // =============================================================
        
        /**
         * VARIABLES DE CONTROL PARA PROCESOS ASINCR√ìNICOS
         * Permiten manejar y cancelar procesos en curso
         */
        let progressSimulator = null;      // Intervalo para simular progreso
        let connectionChecker = null;      // Intervalo para verificar conexi√≥n
        
        // =============================================================
        // FUNCIONES DE MEJORA DE EXPERIENCIA DE USUARIO
        // =============================================================
        
        /**
         * SIMULADOR DE PROGRESO VISUAL
         * Crea una barra de progreso realista durante la carga de modelos
         * Mejora la percepci√≥n de velocidad y proporciona feedback visual
         */
        function simulateProgress() {
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            // Mostrar contenedor de progreso
            progressContainer.classList.remove('hidden');
            
            let progress = 0;
            /**
             * ANIMACI√ìN DE PROGRESO INCREMENTAL
             * Incrementa el progreso de forma irregular para simular carga real
             */
            progressSimulator = setInterval(() => {
                progress += Math.random() * 15;  // Incremento aleatorio hasta 15%
                if (progress > 95) progress = 95; // L√≠mite antes de completar
                
                // Actualizar elementos visuales
                progressFill.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '%';
                
                /**
                 * COMPLETAR PROGRESO
                 * Al llegar a 95%, completar en pasos finales
                 */
                if (progress >= 95) {
                    clearInterval(progressSimulator);
                    setTimeout(() => {
                        progress = 100;
                        progressFill.style.width = '100%';
                        progressText.textContent = '100%';
                        
                        // Ocultar barra despu√©s de completar
                        setTimeout(() => {
                            progressContainer.classList.add('hidden');
                        }, 500);
                    }, 200);
                }
            }, 300); // Actualizaci√≥n cada 300ms
        }
        
        /**
         * MONITOR DE CONEXI√ìN A INTERNET
         * Verifica y actualiza el estado de conectividad en tiempo real
         */
        function checkConnection() {
            const indicator = document.getElementById('connectionIndicator');
            const text = document.getElementById('connectionText');
            
            /**
             * ACTUALIZAR INDICADOR SEG√öN ESTADO
             * Cambia color y texto basado en navigator.onLine
             */
            if (navigator.onLine) {
                indicator.classList.remove('offline');
                text.textContent = 'Conectado';
            } else {
                indicator.classList.add('offline');
                text.textContent = 'Sin conexi√≥n';
            }
        }
        
        /**
         * SISTEMA DE NOTIFICACIONES TOAST
         * Muestra notificaciones no intrusivas con auto-dismissal
         * 
         * @param {string} message - Mensaje a mostrar
         * @param {string} type - Tipo de notificaci√≥n ('info', 'success', 'error', 'warning')
         * @param {number} duration - Duraci√≥n en milisegundos (default: 3000)
         */
        function showNotification(message, type = 'info', duration = 3000) {
            // Crear elemento de notificaci√≥n din√°micamente
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            /**
             * ESTRUCTURA HTML DE LA NOTIFICACI√ìN
             * Incluye √≠cono apropiado seg√∫n el tipo
             */
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.2rem;">
                        ${type === 'success' ? '‚úÖ' : 
                          type === 'error' ? '‚ùå' : 
                          type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}
                    </span>
                    <span>${message}</span>
                </div>
            `;
            
            // Agregar al DOM
            document.body.appendChild(notification);
            
            /**
             * ANIMACI√ìN DE ENTRADA
             * Delay peque√±o para permitir que el CSS se aplique
             */
            setTimeout(() => notification.classList.add('show'), 100);
            
            /**
             * AUTO-DISMISSAL CON ANIMACI√ìN
             * Oculta y remueve la notificaci√≥n despu√©s del tiempo especificado
             */
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300); // Tiempo para animaci√≥n de salida
            }, duration);
        }
        
        /**
         * TOGGLE DE AYUDA DE ATAJOS DE TECLADO
         * Muestra/oculta el panel flotante de ayuda
         */
        function toggleShortcutsHelp() {
            const help = document.getElementById('shortcutsHelp');
            help.classList.toggle('show');
        }
        
        /**
         * SISTEMA DE ALERTAS DE SEGURIDAD
         * Muestra advertencias de seguridad importantes
         * 
         * @param {string} message - Mensaje de seguridad
         * @param {string} level - Nivel de alerta (default: 'warning')
         */
        function showSecurityWarning(message, level = 'warning') {
            const warning = document.getElementById('securityWarning');
            const messageSpan = document.getElementById('securityMessage');
            
            // Actualizar contenido y mostrar
            messageSpan.textContent = message;
            warning.classList.remove('hidden');
            
            /**
             * AUTO-OCULTAMIENTO DE SEGURIDAD
             * Las alertas de seguridad se ocultan autom√°ticamente despu√©s de 10 segundos
             */
            setTimeout(() => {
                warning.classList.add('hidden');
            }, 10000);
        }
        
        // =============================================================
        // EVENT LISTENERS PARA FUNCIONALIDAD EXTENDIDA
        // =============================================================
        
        /**
         * MANEJO DE ATAJOS DE TECLADO EXTENDIDOS
         * Captura teclas adicionales para funcionalidad avanzada
         */
        document.addEventListener('keydown', function(event) {
            // Prevenir interferencia con campos de entrada
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }
            
            /**
             * MAPEO DE TECLAS ESPECIALES
             * Atajos adicionales para funciones de ayuda
             */
            switch(event.key.toLowerCase()) {
                case '?':
                    event.preventDefault();
                    toggleShortcutsHelp();
                    break;
                case 'h':
                    event.preventDefault();
                    toggleShortcutsHelp();
                    break;
            }
        });
        
        /**
         * LISTENERS PARA EVENTOS DE CONEXI√ìN
         * Monitoreo autom√°tico de cambios en la conectividad
         */
        window.addEventListener('online', checkConnection);
        window.addEventListener('offline', checkConnection);
        
        /**
         * PREVENCI√ìN DE ZOOM ACCIDENTAL EN M√ìVILES
         * Evita zoom por doble tap que puede interferir con la interfaz
         */
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault(); // Prevenir zoom por doble tap
            }
            lastTouchEnd = now;
        }, false);
        
        // =============================================================
        // FUNCIONES DE INICIALIZACI√ìN MEJORADA
        // =============================================================
        
        /**
         * INICIALIZACI√ìN EXTENDIDA DEL SISTEMA
         * Se ejecuta cuando el DOM est√° completamente cargado
         * Configura todas las mejoras de UX
         */
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Iniciando sistema de login facial mejorado...');
            
            /**
             * VERIFICACI√ìN INICIAL DE CONEXI√ìN
             * Estado baseline de conectividad
             */
            checkConnection();
            
            /**
             * MONITOREO PERI√ìDICO DE CONEXI√ìN
             * Verificaci√≥n cada 30 segundos para mantener estado actualizado
             */
            connectionChecker = setInterval(checkConnection, 30000);
            
            /**
             * INICIAR SIMULACI√ìN DE PROGRESO
             * Feedback visual durante la carga inicial
             */
            simulateProgress();
            
            /**
             * NOTIFICACI√ìN DE INICIO
             * Confirmar al usuario que el sistema est√° inicializando
             */
            setTimeout(() => {
                showNotification('Sistema de login facial iniciado', 'info', 2000);
            }, 1000);
            
            /**
             * ACTIVAR RESPONSIVIDAD DE C√ÅMARA
             * Configurar el contenedor de c√°mara para mejor UX
             */
            const cameraContainer = document.getElementById('cameraContainer');
            cameraContainer.classList.add('active');
            
            console.log('‚úÖ Mejoras de UX aplicadas');
        });
        
        /**
         * LIMPIEZA DE RECURSOS AL CERRAR
         * Libera intervalos y recursos antes de cerrar la p√°gina
         */
        window.addEventListener('beforeunload', function() {
            if (progressSimulator) clearInterval(progressSimulator);
            if (connectionChecker) clearInterval(connectionChecker);
        });
        
        // =============================================================
        // OVERRIDES Y EXTENSIONES DE FUNCIONES PRINCIPALES
        // =============================================================
        
        /**
         * EXTENSI√ìN DE LA FUNCI√ìN updateStatus
         * Mejora la funci√≥n original con notificaciones adicionales
         */
        const originalUpdateStatus = window.updateStatus || function() {};
        window.updateStatus = function(message, type = 'info', showSpinner = false) {
            /**
             * LLAMAR FUNCI√ìN ORIGINAL
             * Mantener funcionalidad existente
             */
            if (originalUpdateStatus !== window.updateStatus) {
                originalUpdateStatus.call(this, message, type, showSpinner);
            }
            
            /**
             * ACTUALIZAR ELEMENTO DOM DE STATUS
             * Sincronizar con la interfaz visual
             */
            const status = document.getElementById('status');
            if (status) {
                status.className = `status ${type}`;
                status.innerHTML = showSpinner ? 
                    `<div class="spinner"></div>${message}` : 
                    message;
            }
            
            /**
             * NOTIFICACIONES PARA ESTADOS IMPORTANTES
             * Solo mostrar toast para √©xito y errores
             */
            if (type === 'success' || type === 'error') {
                // Limpiar emojis del mensaje para las notificaciones
                const cleanMessage = message.replace(/[üéâ‚úÖ‚ùå‚ö†Ô∏èüìπüîç‚è∏Ô∏èüóëÔ∏è]/g, '').trim();
                showNotification(cleanMessage, type, 4000);
            }
        };
        
        console.log('üé® Mejoras de interfaz cargadas');
    </script>
    
    <!-- =================================================================
         SCRIPT PRINCIPAL DE LA APLICACI√ìN
         ================================================================= -->
    
    <!--
        CARGA DEL SCRIPT PRINCIPAL
        Contiene toda la l√≥gica de reconocimiento facial y funcionalidad core
        Se carga al final para asegurar que el DOM est√© listo
    -->
    <script src="script.js"></script>
</body>
</html>

<!--
    DOCUMENTACI√ìN ADICIONAL Y NOTAS T√âCNICAS
    =========================================
    
    ESTRUCTURA DE ARCHIVOS REQUERIDOS:
    - index.html (este archivo): Estructura principal
    - styles.css: Hoja de estilos completa
    - script.js: L√≥gica de reconocimiento facial
    
    DEPENDENCIAS EXTERNAS:
    - Face-API.js v0.22.2: Biblioteca de reconocimiento facial
    - TensorFlow.js: Motor de IA (incluido en Face-API.js)
    
    APIS UTILIZADAS:
    - MediaDevices.getUserMedia(): Acceso a c√°mara web
    - Canvas API: Manipulaci√≥n de im√°genes y overlays
    - Web Storage API: Persistencia de datos local
    - Fetch API: Requests HTTP para CDNs
    
    CARACTER√çSTICAS DE SEGURIDAD:
    - Content Security Policy (CSP) compatible
    - No eval() o innerHTML peligroso
    - Validaci√≥n de inputs del usuario
    - Manejo seguro de errores
    
    OPTIMIZACIONES DE RENDIMIENTO:
    - Preconnect a CDNs cr√≠ticos
    - CSS cr√≠tico inline
    - Scripts defer y async donde apropiado
    - Lazy loading de recursos no cr√≠ticos
    
    ACCESIBILIDAD:
    - Navegaci√≥n por teclado completa
    - Tooltips descriptivos en botones
    - Contrastes de color adecuados
    - Soporte para lectores de pantalla
    
    RESPONSIVE DESIGN:
    - Mobile-first approach
    - Breakpoints para tablet y m√≥vil
    - Touch-friendly interface
    - Orientaci√≥n adaptive
    
    COMPATIBILIDAD DE NAVEGADORES:
    - Chrome 60+ (recomendado)
    - Firefox 55+
    - Safari 12+
    - Edge 79+
    - Soporte limitado en navegadores antiguos
    
    LIMITACIONES CONOCIDAS:
    - Requiere HTTPS para acceso a c√°mara (excepto localhost)
    - No funciona en navegadores sin soporte WebRTC
    - Rendimiento variable en dispositivos de gama baja
    - Precisi√≥n afectada por iluminaci√≥n y calidad de c√°mara
    
    CONSIDERACIONES DE PRIVACIDAD:
    - Datos biom√©tricos almacenados localmente
    - No transmisi√≥n de datos faciales a servidores
    - Posibilidad de limpieza completa de datos
    - Transparencia sobre el procesamiento de datos
    
    MANTENIMIENTO Y EXTENSIONES:
    - C√≥digo modular para f√°cil extensi√≥n
    - Logging comprensivo para debugging
    - Configuraci√≥n centralizada
    - Patrones de dise√±o escalables
    
    M√âTRICAS DE C√ìDIGO:
    - L√≠neas HTML: ~400+
    - L√≠neas CSS inline: ~200+
    - L√≠neas JavaScript: ~300+
    - Total elementos DOM: ~30+
    - Componentes principales: 8
    
    TESTING RECOMENDADO:
    - Pruebas en m√∫ltiples navegadores
    - Testing en dispositivos m√≥viles
    - Verificaci√≥n de accesibilidad
    - Pruebas de rendimiento
    - Testing de conectividad limitada
-->
